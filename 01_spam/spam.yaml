name: spam

workdir: .

resources:
  cloud: gcp
  region: us-east4
  zone: us-east4-c
  instance_type: n1-standard-8
  disk_size: 100
  accelerators: T4:1

file_mounts:
  /sky/train.exs: ./01_spam/train.exs
  /sky/inputs: ./01_spam/data/combined
  /sky/outputs:
    name: mvkvc-sky-spam-model
    store: gcs
    persistent: True
    mode: MOUNT

setup: |
  docker build -t mvkvc/skypilot_ex:v0 .

run: |
  pwd
  ls -la
  ls -la /sky
  ls -la /sky/inputs
  ls -la /sky/outputs
  docker run --rm \
    --gpus all \
    --volume="/sky:/sky:rw" \
    mvkvc/skypilot_ex:v0 /sky/train.exs \
    --train /sky/inputs/train.csv \
    --test /sky/inputs/test.csv \
    --output /sky/outputs/model
